# Advanced Cognitive Modelling (ACM)

This repo contains **Assignment 1** for the ACM course: a **Matching Pennies** tournament where each strategy’s behaviour is **parameterised via Stan** (parameters drawn from Stan priors), and one behavioural model is **fit in Stan** to simulated sequences.

Core design choices:
- **Stan-only strategies**: even the “random” baseline draws its randomness parameter from a **Stan prior** (no fixed `p=0.5` strategy).
- Minimal “high-grade-signal” figure set:
  1) **Matchup bars with uncertainty intervals**
  2) **Role-swap swing** (vertical marker at trial 30; block totals 1–30 vs 31–60)
  3) **Stan posterior parameter plot**

---

## Repo structure

```
.
├─ assignment1.qmd          # Quarto report (renders figures + interpretation)
├─ run_all.R                # One-click pipeline runner
├─ R/
│  ├─ game.R                # Matching pennies game simulator (role swap at trial 30)
│  ├─ strategies.R          # Strategy definitions (StanRandom, WSLS(Stan), k-ToM(Stan))
│  ├─ tournament.R          # Tournament runner + summaries
│  ├─ plotting.R            # The 3–4 required plots
│  ├─ stan_priors.R         # Draw parameters from Stan priors (cmdstanr)
│  ├─ stan_fit.R            # Fit Stan policy model & summarise posterior
│  └─ utils.R               # Small helpers
├─ stan/
│  ├─ prior_random.stan     # Prior for StanRandom baseline
│  ├─ prior_wsls.stan       # Prior for WSLS parameters
│  ├─ prior_ktom.stan       # Prior for k-ToM parameters
│  └─ wsls_policy.stan      # Stan likelihood model fit to sequences
├─ data/
│  └─ processed/            # Saved tournament outputs (CSV)
└─ figs/                    # Saved figures (PNG)
```

---

## Notes on the modelling choices

- **WSLS(Stan)**: behaviour is generated by sampling `(p_repeat_win, p_repeat_loss, lapse)` from `stan/prior_wsls.stan` for each spawned agent.
- **k-ToM(Stan)**: behaviour is generated by sampling ToM parameters (learning/softmax/mixture) from `stan/prior_ktom.stan`.
- **Stan policy fit**: `stan/wsls_policy.stan` is fit to sequences (typically against the StanRandom baseline) to show that inference can recover a WSLS-like signature.
